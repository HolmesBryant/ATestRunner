/**
 * @author Holmes Bryant <https://github.com/HolmesBryant>
 * @version 1.0.0
 * @license MIT
 */
class t extends HTMLElement{debug=!1;#t="converted";#e;#i={tables:!0,ellipsis:!0,ghCodeBlocks:!0,parseImgDimensions:!0,encodeEmails:!0};#s=!1;#o;#n=null;#d=!1;#a;#r;#h;#l;#p=!1;dompurifyUrl="https://cdn.jsdelivr.net/npm/dompurify@3.3.0/+esm";showdownUrl="https://cdn.jsdelivr.net/npm/showdown@2.1.0/+esm";static Showdown;static DOMPurify;static observedAttributes=["debug","display","file","options","sanitize","backslashEscapesHTMLTags","completeHTMLDocument","disableForced4SpacesIndentedSublists","ellipsis","emoji","encodeEmails","excludeTrailingPunctuationFromURLs","ghCodeBlocks","ghCompatibleHeaderId","ghMentions","ghMentionsLink","headerLevelStart","literalMidWordAsterisks","literalMidWordUnderscores","metadata","noHeaderId","omitExtraWLInCodeBlocks","openLinksInNewWindow","parseImgDimensions","prefixHeaderId","rawPrefixHeaderId","rawHeaderId","requireSpaceBeforeHeadingText","simpleLineBreaks","simplifiedAutoLink","smartIndentationFix","smoothLivePreview","splitAdjacentBlockquotes","strikethrough","tables","tablesHeaderId","tasklists","underline"];constructor(){super()}attributeChangedCallback(t,e,i){if(e===i)return;const s=!(t in{display:1,file:1,options:1,ghMentionsLink:1}),o=s?null!==i&&"false"!==i:i;if(s)this.#u(t,o);else switch(t){case"debug":this.debug=o;break;case"display":this.#t=o;break;case"file":this.#e=o;break;case"options":try{const t=JSON.parse(i);this.#i={...this.#i,...t},this.#p&&this.#c()}catch(t){console.error("Error: Failed to parse options.",t)}break;case"sanitize":this.#s=o,this.#w()}}connectedCallback(){this.#c()}disconnectedCallback(){clearTimeout(this.#n),this.#o=null,this.#l=null,this.#a=null,this.#e instanceof URL&&URL.revokeObjectURL(this.#e),this.#e=null}#u(t,e){this.#i[t]=e,this.#p&&(this.#o.setOption(t,e),this.#m())}#b(t){return!1!==t&&"false"!==t}#g(t){const e=new Blob([t],{type:"text/markdown"});return URL.createObjectURL(e)}#k(t){const e=(t||"").split("\n");let i=null;for(const t of e)if(t.trim().length>0){const e=t.match(/^(\s*)/),s=e?.[0].length??0;(null===i||s<i)&&(i=s)}return i>0?e.map(t=>t.substring(i)).join("\n"):t}async#f(t){return(await this.#w()).sanitize(t)}async#w(){if(this.#a)return this.#a;if(t.DOMPurify)return this.#a=t.DOMPurify,this.#a;const e=await this.#L("dompurify",this.dompurifyUrl);return this.#a=e.default,t.DOMPurify=this.#a,this.#a}async#L(t,e){try{return await import(t)}catch(t){return await import(e)}}async#B(){let e;const i=[];if(t.Showdown)this.#l=t.Showdown;else{const e=this.#L("showdown",this.showdownUrl).then(e=>{this.#l=e.default,t.Showdown=this.#l});i.push(e)}if(this.#s){const t=this.#w();i.push(t)}if(this.hasAttribute("file"))e=fetch(this.#e),this.#d=!1,i.push(e);else if(this.textContent.trim().length>0){this.#d=!0;const t=new Blob([this.textContent],{type:"text/markdown"});e=fetch(URL.createObjectURL(t))}const s=await Promise.allSettled(i);for(const t of s)"rejected"===t.status&&console.error("Failed to load a required asset.",t.reason);if(e){const t=await(await e).text();this.#h=this.#d?this.#k(t):t}else this.#h="";if(!this.#l)throw new Error("Showdown library could not be loaded.")}async#c(){await this.#B(),this.#o=new this.#l.Converter(this.#i),await this.#I(),this.#p=!0}#m(){clearTimeout(this.#n),this.#n=setTimeout(()=>this.#I(),this.renderDebounce)}async#I(){if(!this.#l)throw new Error("Showdown library not found!");if(!this.#o)throw new Error("Showdown converter not initialized!");this.html=await this.#H(this.#o,this.#h),"markdown"===this.#t?this.textContent=this.#h:"html"===this.#t?this.textContent=this.#r:this.innerHTML=this.#r}async#H(){const t=this.#h;try{let e=this.#o.makeHtml(t);return this.#s&&(e=await this.#f(e)),e}catch(t){throw new Error(`Error transforming markdown: ${t.message}`,{cause:t})}}get display(){return this.#t}set display(t){this.setAttribute("display",t),this.#t=t,this.#p&&this.#m()}get file(){return this.#e}set file(t){this.setAttribute("file",t),this.#e=t,this.#c()}get html(){return this.#r}set html(t){this.#r=t}get markdown(){return this.#h}set markdown(t){this.#h=t,this.#p&&this.#m()}get options(){return this.#i}set options(t){this.setAttribute("options",JSON.stringify(t))}get sanitize(){return this.#s}set sanitize(t){const e=this.#b(t);this.setAttribute("sanitize",e),this.#s=e,this.#p&&this.#m()}get backslashEscapesHTMLTags(){return this.#i.backslashEscapesHTMLTags}set backslashEscapesHTMLTags(t){window.abind&&abind.update(this,"backslashEscapesHTMLTags",t),this.#u("backslashEscapesHTMLTags",this.#b(t))}get completeHTMLDocument(){return this.#i.completeHTMLDocument}set completeHTMLDocument(t){window.abind&&abind.update(this,"completeHTMLDocument",t),this.#u("completeHTMLDocument",this.#b(t))}get disableForced4SpacesIndentedSublists(){return this.#i.XXX}set disableForced4SpacesIndentedSublists(t){window.abind&&abind.update(this,"disableForced4SpacesIndentedSublists",t),this.#u("disableForced4SpacesIndentedSublists",this.#b(t))}get ellipsis(){return this.#i.ellipsis}set ellipsis(t){window.abind&&abind.update(this,"ellipsis",t),this.#u("ellipsis",this.#b(t))}get emoji(){return this.#i.emoji}set emoji(t){window.abind&&abind.update(this,"emoji",t),this.#u("emoji",this.#b(t))}get encodeEmails(){return this.#i.encodeEmails}set encodeEmails(t){window.abind&&abind.update(this,"encodeEmails",t),this.#u("encodeEmails",this.#b(t))}get excludeTrailingPunctuationFromURLs(){return this.#i.excludeTrailingPunctuationFromURLs}set excludeTrailingPunctuationFromURLs(t){window.abind&&abind.update(this,"excludeTrailingPunctuationFromURLs",t),this.#u("excludeTrailingPunctuationFromURLs",this.#b(t))}get ghCodeBlocks(){return this.#i.ghCodeBlocks}set ghCodeBlocks(t){window.abind&&abind.update(this,"ghCodeBlocks",t),this.#u("ghCodeBlocks",this.#b(t))}get ghCompatibleHeaderId(){return this.#i.ghCompatibleHeaderId}set ghCompatibleHeaderId(t){window.abind&&abind.update(this,"ghCompatibleHeaderId",t),this.#u("ghCompatibleHeaderId",this.#b(t))}get ghMentions(){return this.#i.ghMentions}set ghMentions(t){window.abind&&abind.update(this,"ghMentions",t),this.#u("ghMentions",this.#b(t))}get ghMentionsLink(){return this.#i.ghMentionsLink}set ghMentionsLink(t){window.abind&&abind.update(this,"ghMentionsLink",t),this.#u("ghMentionsLink",this.#b(t))}get headerLevelStart(){return this.#i.headerLevelStart}set headerLevelStart(t){window.abind&&abind.update(this,"headerLevelStart",t),this.#u("headerLevelStart",this.#b(t))}get literalMidWordAsterisks(){return this.#i.literalMidWordAsterisks}set literalMidWordAsterisks(t){window.abind&&abind.update(this,"literalMidWordAsterisks",t),this.#u("literalMidWordAsterisks",this.#b(t))}get literalMidWordUnderscores(){return this.#i.literalMidWordUnderscores}set literalMidWordUnderscores(t){window.abind&&abind.update(this,"literalMidWordUnderscores",t),this.#u("literalMidWordUnderscores",this.#b(t))}get metadata(){return this.#i.metadata}set metadata(t){window.abind&&abind.update(this,"metadata",t),this.#u("metadata",this.#b(t))}get noHeaderId(){return this.#i.noHeaderId}set noHeaderId(t){window.abind&&abind.update(this,"noHeaderId",t),this.#u("noHeaderId",this.#b(t))}get omitExtraWLInCodeBlocks(){return this.#i.omitExtraWLInCodeBlocks}set omitExtraWLInCodeBlocks(t){window.abind&&abind.update(this,"omitExtraWLInCodeBlocks",t),this.#u("omitExtraWLInCodeBlocks",this.#b(t))}get openLinksInNewWindow(){return this.#i.openLinksInNewWindow}set openLinksInNewWindow(t){window.abind&&abind.update(this,"openLinksInNewWindow",t),this.#u("openLinksInNewWindow",this.#b(t))}get parseImgDimensions(){return this.#i.parseImgDimensions}set parseImgDimensions(t){window.abind&&abind.update(this,"parseImgDimensions",t),this.#u("parseImgDimensions",this.#b(t))}get prefixHeaderId(){return this.#i.prefixHeaderId}set prefixHeaderId(t){window.abind&&abind.update(this,"prefixHeaderId",t),this.#u("prefixHeaderId",this.#b(t))}get rawPrefixHeaderId(){return this.#i.rawPrefixHeaderId}set rawPrefixHeaderId(t){window.abind&&abind.update(this,"rawPrefixHeaderId",t),this.#u("rawPrefixHeaderId",this.#b(t))}get rawHeaderId(){return this.#i.rawHeaderId}set rawHeaderId(t){window.abind&&abind.update(this,"rawHeaderId",t),this.#u("rawHeaderId",this.#b(t))}get requireSpaceBeforeHeadingText(){return this.#i.requireSpaceBeforeHeadingText}set requireSpaceBeforeHeadingText(t){window.abind&&abind.update(this,"requireSpaceBeforeHeadingText",t),this.#u("requireSpaceBeforeHeadingText",this.#b(t))}get simpleLineBreaks(){return this.#i.simpleLineBreaks}set simpleLineBreaks(t){window.abind&&abind.update(this,"simpleLineBreaks",t),this.#u("simpleLineBreaks",this.#b(t))}get simplifiedAutoLink(){return this.#i.simplifiedAutoLink}set simplifiedAutoLink(t){window.abind&&abind.update(this,"simplifiedAutoLink",t),this.#u("simplifiedAutoLink",this.#b(t))}get smartIndentationFix(){return this.#i.smartIndentationFix}set smartIndentationFix(t){window.abind&&abind.update(this,"smartIndentationFix",t),this.#u("smartIndentationFix",this.#b(t))}get smoothLivePreview(){return this.#i.smoothLivePreview}set smoothLivePreview(t){window.abind&&abind.update(this,"smoothLivePreview",t),this.#u("smoothLivePreview",this.#b(t))}get splitAdjacentBlockquotes(){return this.#i.splitAdjacentBlockquotes}set splitAdjacentBlockquotes(t){window.abind&&abind.update(this,"splitAdjacentBlockquotes",t),this.#u("splitAdjacentBlockquotes",this.#b(t))}get strikethrough(){return this.#i.strikethrough}set strikethrough(t){window.abind&&abind.update(this,"strikethrough",t),this.#u("strikethrough",this.#b(t))}get tables(){return this.#i.tables}set tables(t){window.abind&&abind.update(this,"tables",t),this.#u("tables",this.#b(t))}get tablesHeaderId(){return this.#i.tablesHeaderId}set tablesHeaderId(t){window.abind&&abind.update(this,"tablesHeaderId",t),this.#u("tablesHeaderId",this.#b(t))}get tasklists(){return this.#i.tasklists}set tasklists(t){window.abind&&abind.update(this,"tasklists",t),this.#u("tasklists",this.#b(t))}get underline(){return this.#i.underline}set underline(t){this.#u("underline",this.#b(t))}}customElements.get("a-markdown")||customElements.define("a-markdown",t);export{t as default};
